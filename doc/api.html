<!DOCTYPE html>

<!--
    Material Design Lite
    Copyright 2015 Google Inc. All rights reserved.

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

    https://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License
  -->
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <title>Koru API</title>

    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:regular,bold,italic,thin,light,bolditalic,black,medium&amp;lang=en">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://code.getmdl.io/1.1.3/material.blue_grey-deep_purple.min.css">
    <link rel="stylesheet" href="api.css">
  </head>
  <body class="mdl-demo mdl-color-text--grey-700 mdl-base">
    <div class="mdl-layout mdl-js-layout mdl-layout--fixed-drawer
                mdl-layout--fixed-header">
      <header class="mdl-layout__header">
        <div class="mdl-layout__header-row">
          <div class="page-header" data-api="header">
          </div>
          <div class="mdl-layout-spacer"></div>
          <div class="mdl-textfield mdl-js-textfield mdl-textfield--expandable
                      mdl-textfield--floating-label mdl-textfield--align-right">
            <label class="mdl-button mdl-js-button mdl-button--icon" for="fixed-header-drawer-exp">
              <i class="material-icons">search</i>
            </label>
            <div class="mdl-textfield__expandable-holder">
              <input class="mdl-textfield__input" type="text" name="sample" id="fixed-header-drawer-exp">
            </div>
          </div>
        </div>
      </header>
      <div class="mdl-layout__drawer">
        <span class="mdl-layout-title">Modules</span>
        <nav id="jsdoc-index" class="mdl-navigation" data-api="links">
        <div class="jsdoc-nav-module"><a class="jsdoc-idLink" href="#koru/main">koru</a><nav><a href="#koru/main.onunload">onunload</a><a href="#koru/main.findPath">findPath</a><a href="#koru/main.isRequiredBy">isRequiredBy</a></nav></div><div class="jsdoc-nav-module"><a class="jsdoc-idLink" href="#koru/css/loader"><span><span class="jsdoc-nav-spacer">&nbsp;</span>css/loader</span></a><nav><a href="#koru/css/loader.constructor">constructor</a><a href="#koru/css/loader#loadAll">#loadAll</a></nav></div><div class="jsdoc-nav-module"><a class="jsdoc-idLink" href="#koru/dom"><span><span class="jsdoc-nav-spacer">&nbsp;</span>dom</span></a><nav></nav></div><div class="jsdoc-nav-module"><a class="jsdoc-idLink" href="#koru/dom/base"><span><span class="jsdoc-nav-spacer">&nbsp;&nbsp;&nbsp;</span>base</span></a><nav><a href="#koru/dom/base.htmlToJson">htmlToJson</a><a href="#koru/dom/base.h">h</a></nav></div><div class="jsdoc-nav-module"><a class="jsdoc-idLink" href="#koru/dom/ctx"><span><span class="jsdoc-nav-spacer">&nbsp;&nbsp;&nbsp;</span>ctx</span></a><nav></nav></div><div class="jsdoc-nav-module"><a class="jsdoc-idLink" href="#koru/dom/dom-client"><span><span class="jsdoc-nav-spacer">&nbsp;&nbsp;&nbsp;</span>dom-client</span></a><nav><a href="#koru/dom/dom-client.isInView">isInView</a></nav></div><div class="jsdoc-nav-module"><a class="jsdoc-idLink" href="#koru/dom/dom-server"><span><span class="jsdoc-nav-spacer">&nbsp;&nbsp;&nbsp;</span>dom-server</span></a><nav></nav></div><div class="jsdoc-nav-module"><a class="jsdoc-idLink" href="#koru/dom/html-doc"><span><span class="jsdoc-nav-spacer">&nbsp;&nbsp;&nbsp;</span>html-doc</span></a><nav><a href="#koru/dom/html-doc#replaceChild">#replaceChild</a></nav><div class="jsdoc-nav-module"><a class="jsdoc-idLink" href="#koru/dom/html-doc::Element">::Element</a><nav><a href="#koru/dom/html-doc::Element#getElementsByClassName">#getElementsByClassName</a></nav></div></div><div class="jsdoc-nav-module"><a class="jsdoc-idLink" href="#koru/dom/template"><span><span class="jsdoc-nav-spacer">&nbsp;&nbsp;&nbsp;</span>template</span></a><nav><a href="#koru/dom/template.newTemplate">newTemplate</a></nav></div><div class="jsdoc-nav-module"><a class="jsdoc-idLink" href="#koru/idle-check"><span><span class="jsdoc-nav-spacer">&nbsp;</span>idle-check</span></a><nav><a href="#koru/idle-check.constructor">constructor</a><a href="#koru/idle-check#waitIdle">#waitIdle</a></nav></div><div class="jsdoc-nav-module"><a class="jsdoc-idLink" href="#koru/pg/driver"><span><span class="jsdoc-nav-spacer">&nbsp;</span>pg/driver</span></a><nav><a href="#koru/pg/driver.connect">connect</a></nav><div class="jsdoc-nav-module"><a class="jsdoc-idLink" href="#koru/pg/driver::Client">::Client</a><nav><a href="#koru/pg/driver::Client#jsFieldToPg">#jsFieldToPg</a></nav></div></div><div class="jsdoc-nav-module"><a class="jsdoc-idLink" href="#koru/session/main"><span><span class="jsdoc-nav-spacer">&nbsp;</span>session</span></a><nav><a href="#koru/session/main.defineRpc">defineRpc</a></nav></div><div class="jsdoc-nav-module"><a class="jsdoc-idLink" href="#koru/session/client-sub"><span><span class="jsdoc-nav-spacer">&nbsp;&nbsp;&nbsp;</span>client-sub</span></a><nav><a href="#koru/session/client-sub#filterModels">#filterModels</a></nav></div><div class="jsdoc-nav-module"><a class="jsdoc-idLink" href="#koru/session/publish-test-helper-client"><span><span class="jsdoc-nav-spacer">&nbsp;&nbsp;&nbsp;</span>publish-test-helper-client</span></a><nav><a href="#koru/session/publish-test-helper-client.mockSubscribe">mockSubscribe</a></nav></div><div class="jsdoc-nav-module"><a class="jsdoc-idLink" href="#koru/session/subscribe"><span><span class="jsdoc-nav-spacer">&nbsp;&nbsp;&nbsp;</span>subscribe</span></a><nav></nav></div><div class="jsdoc-nav-module"><a class="jsdoc-idLink" href="#koru/session/subscribe-factory"><span><span class="jsdoc-nav-spacer">&nbsp;&nbsp;&nbsp;</span>subscribe-factory</span></a><nav><a href="#koru/session/subscribe-factory.constructor">constructor</a></nav></div><div class="jsdoc-nav-module"><a class="jsdoc-idLink" href="#koru/session/web-socket-sender-factory"><span><span class="jsdoc-nav-spacer">&nbsp;&nbsp;&nbsp;</span>web-socket-sender-factory</span></a><nav><a href="#koru/session/web-socket-sender-factory.constructor">constructor</a></nav></div><div class="jsdoc-nav-module"><a class="jsdoc-idLink" href="#koru/test/api"><span><span class="jsdoc-nav-spacer">&nbsp;</span>test/api</span></a><nav><a href="#koru/test/api.module">module</a><a href="#koru/test/api.innerSubject">innerSubject</a><a href="#koru/test/api.example">example</a><a href="#koru/test/api.comment">comment</a><a href="#koru/test/api.property">property</a><a href="#koru/test/api.protoProperty">protoProperty</a><a href="#koru/test/api.new">new</a><a href="#koru/test/api.method">method</a><a href="#koru/test/api.protoMethod">protoMethod</a></nav></div><div class="jsdoc-nav-module"><a class="jsdoc-idLink" href="#koru/ui/route"><span><span class="jsdoc-nav-spacer">&nbsp;</span>ui/route</span></a><nav><a href="#koru/ui/route.setTitle">setTitle</a><a href="#koru/ui/route.gotoPage">gotoPage</a><a href="#koru/ui/route.replacePage">replacePage</a></nav></div><div class="jsdoc-nav-module"><a class="jsdoc-idLink" href="#koru/util"><span><span class="jsdoc-nav-spacer">&nbsp;</span>util</span></a><nav><a href="#koru/util.toDp">toDp</a><a href="#koru/util.pc">pc</a><a href="#koru/util.px">px</a><a href="#koru/util.removeItem">removeItem</a><a href="#koru/util.intersectp">intersectp</a><a href="#koru/util.reverseForEach">reverseForEach</a></nav></div><div class="jsdoc-nav-module"><a class="jsdoc-idLink" href="#koru/web-server"><span><span class="jsdoc-nav-spacer">&nbsp;</span>web-server</span></a><nav><a href="#koru/web-server.start">start</a></nav></div><div class="jsdoc-nav-module"><a class="jsdoc-idLink" href="#koru/web-server-factory"><span><span class="jsdoc-nav-spacer">&nbsp;</span>web-server-factory</span></a><nav><a href="#koru/web-server-factory.constructor">constructor</a><a href="#koru/web-server-factory#start">#start</a><a href="#koru/web-server-factory#stop">#stop</a></nav></div></nav>
      </div>
      <main class="mdl-layout__content">
        <div class="page-content" data-api="pages">
        <section class="jsdoc-module" id="koru/main"><a class="jsdoc-module-path" href="#koru/main">koru/main</a><h2 class="jsdoc-module-title">koru</h2><abstract><div><p>Main koru module. Responsible for:</p>
<ul>
<li>Fibers</li>
<li>Logging</li>
<li>Dependency tracking and load/unload manager</li>
<li>AppDir location</li>
</ul>
</div></abstract><aside class="jsdoc-module-sidebar"><div><h5>Modules required</h5><div class="jsdoc-list"><a class="jsdoc-link" href="#"></a><span><a class="jsdoc-link" href="#koru/main-client">koru/main-client</a><br><a class="jsdoc-link" href="#koru/main-server">koru/main-server</a></span><a class="jsdoc-link" href="#koru/errors">koru/errors</a><a class="jsdoc-link" href="#koru/util">koru/util</a><a class="jsdoc-link" href="#koru/yaajs-graph">koru/yaajs-graph</a></div></div></aside><div><div class="jsdoc-methods"><h4>Methods</h4><div><div class=" jsdoc-module-section" id="koru/main.onunload" name="onunload"><h5>koru.onunload(moduleOrId, callback)</h5><abstract><div><p>A wrapper around <code>module#onUnload</code>. see <a href="https://www.npmjs.com/package/yaajs">https://www.npmjs.com/package/yaajs</a></p>
</div></abstract><div class="jsdoc-args"><h6>Parameters</h6><table><tbody><tr class="jsdoc-arg"><td>moduleOrId</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a>&nbsp;or<br><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></td><td class="jsdoc-info"><div></div></td></tr><tr class="jsdoc-arg"><td>callback</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a>&nbsp;or<br><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function">function</a></td><td class="jsdoc-info"><div></div></td></tr></tbody></table></div><div><h6>Example</h6><pre class="jsdoc-example"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">koru</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/main"</span>);</div><div class="jsdoc-example-call jsdoc-code-block"><div class="highlight"><span class="kd">const</span> <span class="nx">myModule</span> = { <span class="na">id</span>: <span class="s">'myModule'</span>, <span class="na">onUnload</span>: <span class="nx">test</span>.<span class="na">stub</span>() };
<span class="kd">const</span> <span class="nx">callback</span> = { <span class="nf">stop</span>() {} };
<span class="nx">koru</span>.<span class="na">onunload</span>(<span class="nx">myModule</span>, <span class="nx">callback</span>);
<span class="nx">assert</span>.<span class="na">calledWith</span>(<span class="nx">myModule</span>.<span class="na">onUnload</span>, <span class="nx">callback</span>.<span class="na">stop</span>);</div></div><div class="jsdoc-example-call highlight"><div><span class="nx">koru</span>.<span class="na">onunload</span>(<span class="s">"koru/main-test"</span>, <span class="ge nx">stub</span>);</div><div></div></div></pre></div></div><div class=" jsdoc-module-section" id="koru/main.findPath" name="findPath"><h5>koru.findPath(start, goal)</h5><abstract><div><p>Finds shortest dependency path from one module to another
module that it (indirectly) requires.</p>
</div></abstract><div class="jsdoc-args"><h6>Parameters</h6><table><tbody><tr class="jsdoc-arg"><td>start</td><td><a href="https://www.npmjs.com/package/yaajs#api_Module">Module</a></td><td class="jsdoc-info"><div><p>the module to start from</p>
</div></td></tr><tr class="jsdoc-arg"><td>goal</td><td><a href="https://www.npmjs.com/package/yaajs#api_Module">Module</a></td><td class="jsdoc-info"><div><p>the module to look for</p>
</div></td></tr><tr class="jsdoc-method-returns"><td><h6>Returns</h6></td><td><a href="https://www.npmjs.com/package/yaajs#api_Module">[Module,...]</a></td><td class="jsdoc-info"><div><p>from <code>start</code> to <code>goal</code></p>
</div></td></tr></tbody></table></div><div><h6>Example</h6><pre class="jsdoc-example"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">koru</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/main"</span>);</div><div class="jsdoc-example-call highlight"><div><span class="nx">koru</span>.<span class="na">findPath</span>(<span class="ge nx">{Module:koru/main-test}</span>, <span class="ge nx">{Module:koru/util-base}</span>);</div><span class="jsdoc-returns c1"> // returns <span class="ge nx">[{Module:koru/main-test}, {Module:koru/util}, {Module:koru/util-base}]</span></span></div></pre></div></div><div class=" jsdoc-module-section" id="koru/main.isRequiredBy" name="isRequiredBy"><h5>koru.isRequiredBy(supplier, user)</h5><abstract><div><p>Test if <code>supplier</code> is required by <code>user</code>.</p>
</div></abstract><div class="jsdoc-args"><h6>Parameters</h6><table><tbody><tr class="jsdoc-arg"><td>supplier</td><td><a href="https://www.npmjs.com/package/yaajs#api_Module">Module</a></td><td class="jsdoc-info"><div><p>the module to look for</p>
</div></td></tr><tr class="jsdoc-arg"><td>user</td><td><a href="https://www.npmjs.com/package/yaajs#api_Module">Module</a></td><td class="jsdoc-info"><div><p>the module to start from</p>
</div></td></tr><tr class="jsdoc-method-returns"><td><h6>Returns</h6></td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></td><td class="jsdoc-info"><div><p>true if path found from user to supplier</p>
</div></td></tr></tbody></table></div><div><h6>Example</h6><pre class="jsdoc-example"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">koru</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/main"</span>);</div><div class="jsdoc-example-call highlight"><div><span class="nx">koru</span>.<span class="na">isRequiredBy</span>(<span class="ge nx">{Module:koru/util-base}</span>, <span class="ge nx">{Module:koru/main-test}</span>);</div><span class="jsdoc-returns c1"> // returns <span class="kc">true</span></span></div><div class="jsdoc-example-call highlight"><div><span class="nx">koru</span>.<span class="na">isRequiredBy</span>(<span class="ge nx">{Module:koru/main-test}</span>, <span class="ge nx">{Module:koru/util-base}</span>);</div><span class="jsdoc-returns c1"> // returns <span class="kc">false</span></span></div></pre></div></div></div></div></div></section><section class="jsdoc-module" id="koru/css/loader"><a class="jsdoc-module-path" href="#koru/css/loader">koru/css/loader</a><h2 class="jsdoc-module-title">CssLoader</h2><abstract><div><p>css/loader allows dynamic replacement of css and less files when
their contents change.</p>
</div></abstract><aside class="jsdoc-module-sidebar"><div class="jsdoc-availability">client only</div><div><h5>Modules required</h5><div class="jsdoc-list"><a class="jsdoc-link" href="#koru/main">koru/main</a></div></div></aside><div><div class=" jsdoc-module-section" id="koru/css/loader.constructor" name="constructor"><h4>constructor(session)</h4><abstract><div><p>Construct a css loader</p>
</div></abstract><div class="jsdoc-args"><h6>Parameters</h6><table><tbody><tr class="jsdoc-arg"><td>session</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></td><td class="jsdoc-info"><div><p>listen for load messages from this session</p>
</div></td></tr></tbody></table></div><div><h6>Example</h6><pre class="jsdoc-example highlight"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">CssLoader</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/css/loader"</span>);</div><div><div class="highlight"><span class="k">new</span> <span class="nx">CssLoader</span>({ <span class="na">_commands</span>: {}, <span class="na">_id</span>: <span class="s">'loader'</span>, <span class="na">_rpcs</span>: {} });</div></div></pre></div></div><div class="jsdoc-methods"><h4>Methods</h4><div><div class=" jsdoc-module-section" id="koru/css/loader#loadAll" name="#loadAll"><h5>CssLoader#loadAll(dir)</h5><abstract><div><p>Load all css and less files under <code>dir</code></p>
</div></abstract><div class="jsdoc-args"><h6>Parameters</h6><table><tbody><tr class="jsdoc-arg"><td>dir</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></td><td class="jsdoc-info"><div></div></td></tr></tbody></table></div><div><h6>Example</h6><pre class="jsdoc-example"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">CssLoader</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/css/loader"</span>);</div><div class="highlight jsdoc-inst-init"><span class="kd">const</span> <span class="nx">cssLoader</span> = <span class="k">new</span> <span class="nx">CssLoader</span>();</div><div class="jsdoc-example-call highlight"><div><span class="nx">cssLoader</span>.<span class="na">loadAll</span>(<span class="s">"koru/css"</span>);</div><div></div></div></pre></div></div></div></div></div></section><section class="jsdoc-module" id="koru/dom"><a class="jsdoc-module-path" href="#koru/dom">koru/dom</a><h2 class="jsdoc-module-title">Dom</h2><abstract><div><p>Main module to require for full Dom utilities.</p>
<p>See <a class="jsdoc-link" href="#koru/dom/base">koru/dom/Dom</a>, <a href="#koru/dom/dom-client">koru/dom/dom-client</a>
and <a href="#koru/dom/dom-server">koru/dom/dom-server</a></p>
</div></abstract><aside class="jsdoc-module-sidebar"><div><h5>Modules required</h5><div class="jsdoc-list"><span><a class="jsdoc-link" href="#koru/dom/dom-client">koru/dom/dom-client</a><br><a class="jsdoc-link" href="#koru/dom/dom-server">koru/dom/dom-server</a></span></div></div><div><h5>Modifies modules</h5><div class="jsdoc-list"><a class="jsdoc-link" href="#koru/dom/base">koru/dom/base</a><a class="jsdoc-link" href="#koru/dom/dom-client">koru/dom/dom-client</a><a class="jsdoc-link" href="#koru/dom/dom-server">koru/dom/dom-server</a></div></div></aside><div></div></section><section class="jsdoc-module" id="koru/dom/base"><a class="jsdoc-module-path" href="#koru/dom/base">koru/dom/base</a><h2 class="jsdoc-module-title">Dom</h2><abstract><div><p>Convert an <code>Element</code> to a plain <code>object</code></p>
</div></abstract><aside class="jsdoc-module-sidebar"><div><h5>Modules required</h5><div class="jsdoc-list"><a class="jsdoc-link" href="#koru/main">koru/main</a><a class="jsdoc-link" href="#koru/util">koru/util</a></div></div><div><h5>Modified by modules</h5><div class="jsdoc-list"><a class="jsdoc-link" href="#koru/dom">koru/dom</a><a class="jsdoc-link" href="#koru/dom/dom-client">koru/dom/dom-client</a><a class="jsdoc-link" href="#koru/dom/dom-server">koru/dom/dom-server</a></div></div></aside><div><div class="jsdoc-methods"><h4>Methods</h4><div><div class=" jsdoc-module-section" id="koru/dom/base.htmlToJson" name="htmlToJson"><h5>Dom.htmlToJson(node)</h5><abstract><div><p>Convert an <code>Element</code> to a plain <code>object</code></p>
</div></abstract><div class="jsdoc-args"><h6>Parameters</h6><table><tbody><tr class="jsdoc-arg"><td>node</td><td><a href="#koru/dom/html-doc::Element">koru/dom/html-doc::Element</a></td><td class="jsdoc-info"><div></div></td></tr><tr class="jsdoc-method-returns"><td><h6>Returns</h6></td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></td><td class="jsdoc-info"><div></div></td></tr></tbody></table></div><div><h6>Example</h6><pre class="jsdoc-example"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">Dom</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/dom/base"</span>);</div><div class="jsdoc-example-call highlight"><div><span class="nx">Dom</span>.<span class="na">htmlToJson</span>(<span class="ge nx">&lt;section class="greeting" id="gId" data-lang="en"&gt;&lt;ul&gt;&lt;li&gt;&lt;span&gt;Hello&lt;/span&gt;&lt;/li&gt;&lt;li&gt;two&lt;/li&gt;&lt;/ul&gt;&lt;/section&gt;</span>);</div><span class="jsdoc-returns c1"> // returns <span class="ge nx">{"$data-lang": 'en', class: 'greeting', id: 'gId', section: {ul: [{li: {span=Hello,...}}, {li: 'two'}]}}</span></span></div></pre></div></div><div class=" jsdoc-module-section" id="koru/dom/base.h" name="h"><h5>Dom.h(body)</h5><abstract><div><p>Convert an <code>object</code> into a html node.</p>
<p><code>id</code> and <code>class</code> convert to attributes but other attributes
must be prefixed with a <code>$</code>.</p>
<p>Array is used when multiple children.
Non prefixed key is used for <code>tagName</code>.</p>
</div></abstract><div class="jsdoc-args"><h6>Parameters</h6><table><tbody><tr class="jsdoc-arg"><td>body</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></td><td class="jsdoc-info"><div></div></td></tr><tr class="jsdoc-method-returns"><td><h6>Returns</h6></td><td><a href="#koru/dom/html-doc::Element">koru/dom/html-doc::Element</a></td><td class="jsdoc-info"><div></div></td></tr></tbody></table></div><div><h6>Example</h6><pre class="jsdoc-example"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">Dom</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/dom/base"</span>);</div><div class="jsdoc-example-call highlight"><div><span class="nx">Dom</span>.<span class="na">h</span>(<span class="ge nx">{"$data-lang": 'en', class: 'greeting', id: 'gId', section: {ul: [{li: {span=Hello,...}}, {li: 'two'}]}}</span>);</div><span class="jsdoc-returns c1"> // returns <span class="ge nx">&lt;section class="greeting" id="gId" data-lang="en"&gt;&lt;ul&gt;&lt;li&gt;&lt;span&gt;Hello&lt;/span&gt;&lt;/li&gt;&lt;li&gt;two&lt;/li&gt;&lt;/ul&gt;&lt;/section&gt;</span></span></div></pre></div></div></div></div></div></section><section class="jsdoc-module" id="koru/dom/ctx"><a class="jsdoc-module-path" href="#koru/dom/ctx">koru/dom/ctx</a><h2 class="jsdoc-module-title">Ctx</h2><abstract><div><p>Ctx is used to track
<a href="https://developer.mozilla.org/en-US/docs/Web/API/Node">DOM elements</a></p>
</div></abstract><aside class="jsdoc-module-sidebar"><div class="jsdoc-availability">client only</div><div><h5>Modules required</h5><div class="jsdoc-list"><a class="jsdoc-link" href="#koru/dom/base">koru/dom/base</a><a class="jsdoc-link" href="#koru/util">koru/util</a></div></div></aside><div></div></section><section class="jsdoc-module" id="koru/dom/dom-client"><a class="jsdoc-module-path" href="#koru/dom/dom-client">koru/dom/dom-client</a><h2 class="jsdoc-module-title">Dom</h2><abstract><div><p>Adorn <a class="jsdoc-link" href="#koru/dom/base">koru/dom/Dom</a> with extra utility functions</p>
</div></abstract><aside class="jsdoc-module-sidebar"><div class="jsdoc-availability">client only</div><div><h5>Modules required</h5><div class="jsdoc-list"><a class="jsdoc-link" href="#koru/dom/ctx">koru/dom/ctx</a><a class="jsdoc-link" href="#koru/dom/dom">koru/dom/dom</a><a class="jsdoc-link" href="#koru/dom/template">koru/dom/template</a><a class="jsdoc-link" href="#koru/main">koru/main</a><a class="jsdoc-link" href="#koru/util">koru/util</a></div></div><div><h5>Modifies modules</h5><div class="jsdoc-list"><a class="jsdoc-link" href="#koru/dom/base">koru/dom/base</a></div></div><div><h5>Modified by modules</h5><div class="jsdoc-list"><a class="jsdoc-link" href="#koru/dom">koru/dom</a></div></div></aside><div><div class="jsdoc-methods"><h4>Methods</h4><div><div class=" jsdoc-module-section" id="koru/dom/dom-client.isInView" name="isInView"><h5>Dom.isInView(elm, region)</h5><abstract><div><p>Determine if a element is within the viewable area of a
<code>region</code>.</p>
</div></abstract><div class="jsdoc-args"><h6>Parameters</h6><table><tbody><tr class="jsdoc-arg"><td>elm</td><td><a href="#koru/dom/html-doc::Element">koru/dom/html-doc::Element</a></td><td class="jsdoc-info"><div></div></td></tr><tr class="jsdoc-arg"><td>region</td><td><a href="#koru/dom/html-doc::Element">koru/dom/html-doc::Element</a>&nbsp;or<br><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></td><td class="jsdoc-info"><div><p>either a Dom <code>Element</code> or a <code>boundingClientRect</code></p>
</div></td></tr><tr class="jsdoc-method-returns"><td><h6>Returns</h6></td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></td><td class="jsdoc-info"><div></div></td></tr></tbody></table></div><div><h6>Example</h6><pre class="jsdoc-example"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">Dom</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/dom/dom-client"</span>);</div><div class="jsdoc-example-call highlight"><div><span class="nx">Dom</span>.<span class="na">isInView</span>(<span class="ge nx">&lt;div style="position:absolute;left:-12px;width:20px;height:30px"&gt;x&lt;/div&gt;</span>, <span class="ge nx">&lt;body&gt;&lt;div style="position:absolute;left:-12px;width:20px;height:30px"&gt;x&lt;/div&gt;&lt;/body&gt;</span>);</div><span class="jsdoc-returns c1"> // returns <span class="kc">false</span></span></div><div class="jsdoc-example-call highlight"><div><span class="nx">Dom</span>.<span class="na">isInView</span>(<span class="ge nx">&lt;div style="position:absolute;left:-12px;width:20px;height:30px"&gt;x&lt;/div&gt;</span>, <span class="ge nx">&lt;body&gt;&lt;div style="position: absolute; left: -9px; width: 20px; height: 30px;"&gt;x&lt;/div&gt;&lt;/body&gt;</span>);</div><span class="jsdoc-returns c1"> // returns <span class="kc">true</span></span></div><div class="jsdoc-example-call highlight"><div><span class="nx">Dom</span>.<span class="na">isInView</span>(<span class="ge nx">&lt;div style="position:absolute;left:-12px;width:20px;height:30px"&gt;x&lt;/div&gt;</span>, <span class="ge nx">{bottom: 50, left: 0, right: 40, top: 0}</span>);</div><span class="jsdoc-returns c1"> // returns <span class="kc">false</span></span></div><div class="jsdoc-example-call highlight"><div><span class="nx">Dom</span>.<span class="na">isInView</span>(<span class="ge nx">&lt;div style="position:absolute;left:-12px;width:20px;height:30px"&gt;x&lt;/div&gt;</span>, <span class="ge nx">{bottom: 2000, left: 0, right: 40, top: 0}</span>);</div><span class="jsdoc-returns c1"> // returns <span class="kc">true</span></span></div></pre></div></div></div></div></div></section><section class="jsdoc-module" id="koru/dom/dom-server"><a class="jsdoc-module-path" href="#koru/dom/dom-server">koru/dom/dom-server</a><h2 class="jsdoc-module-title">Dom</h2><abstract><div><p>Returns <a class="jsdoc-link" href="#koru/dom/base">koru/dom/Dom</a>. Ensures server has <a class="jsdoc-link" href="#koru/dom/html-doc">koru/dom/Document</a></p>
</div></abstract><aside class="jsdoc-module-sidebar"><div class="jsdoc-availability">server only</div><div><h5>Modules required</h5><div class="jsdoc-list"><a class="jsdoc-link" href="#koru/dom/base">koru/dom/base</a><a class="jsdoc-link" href="#koru/dom/html-doc">koru/dom/html-doc</a></div></div><div><h5>Modifies modules</h5><div class="jsdoc-list"><a class="jsdoc-link" href="#koru/dom/base">koru/dom/base</a></div></div><div><h5>Modified by modules</h5><div class="jsdoc-list"><a class="jsdoc-link" href="#koru/dom">koru/dom</a></div></div></aside><div></div></section><section class="jsdoc-module" id="koru/dom/html-doc"><a class="jsdoc-module-path" href="#koru/dom/html-doc">koru/dom/html-doc</a><h2 class="jsdoc-module-title">Document</h2><abstract><div><p>Server side implementation of the DOM tree.</p>
</div></abstract><aside class="jsdoc-module-sidebar"><div><h5>Modules required</h5><div class="jsdoc-list"><a class="jsdoc-link" href="#koru/dom/base">koru/dom/base</a><a class="jsdoc-link" href="#koru/main">koru/main</a><a class="jsdoc-link" href="#koru/util">koru/util</a><a class="jsdoc-link" href="#koru/util-color">koru/util-color</a></div></div></aside><div><div class="jsdoc-methods"><h4>Methods</h4><div><div class=" jsdoc-module-section" id="koru/dom/html-doc#replaceChild" name="#replaceChild"><h5>Document#replaceChild(newNode, oldNode)</h5><abstract><div><p>Replace the <code>oldChild</code> with the <code>newChild</code></p>
<p>See <a href="https://developer.mozilla.org/en-US/docs/Web/API/Node/replaceChild">Node.replaceChild</a></p>
</div></abstract><div class="jsdoc-args"><h6>Parameters</h6><table><tbody><tr class="jsdoc-arg"><td>newNode</td><td><a href="#koru/dom/html-doc::Element">koru/dom/html-doc::Element</a></td><td class="jsdoc-info"><div></div></td></tr><tr class="jsdoc-arg"><td>oldNode</td><td><a href="#koru/dom/html-doc::Element">koru/dom/html-doc::Element</a></td><td class="jsdoc-info"><div></div></td></tr><tr class="jsdoc-method-returns"><td><h6>Returns</h6></td><td><a href="#koru/dom/html-doc::Element">koru/dom/html-doc::Element</a></td><td class="jsdoc-info"><div></div></td></tr></tbody></table></div><div><h6>Example</h6><pre class="jsdoc-example"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">Document</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/dom/html-doc"</span>);</div><div class="jsdoc-example-call jsdoc-code-block"><div class="highlight"><span class="kd">const</span> <span class="nx">parent</span> = <span class="nx">Dom</span>.<span class="na">h</span>({ <span class="na">div</span>: [{ <span class="na">class</span>: <span class="s">'foo'</span> }, { <span class="na">class</span>: <span class="s">'old-node'</span> }] });
<span class="kd">const</span> <span class="nx">oldParent</span> = <span class="nx">Dom</span>.<span class="na">h</span>({ <span class="na">div</span>: { <span class="na">class</span>: <span class="s">'new-node'</span> } });
<span class="kd">const</span> <span class="nx">newNode</span> = <span class="nx">oldParent</span>.<span class="na">firstChild</span>;

<span class="kd">const</span> <span class="nx">oldNode</span> = <span class="nx">parent</span>.<span class="na">replaceChild</span>(<span class="nx">newNode</span>, <span class="nx">parent</span>.<span class="na">getElementsByClassName</span>(<span class="s">'old-node'</span>)[<span class="m">0</span>]);
<span class="nx">assert</span>.<span class="na">className</span>(<span class="nx">oldNode</span>, <span class="s">'old-node'</span>);
<span class="nx">refute</span>(<span class="nx">oldNode</span>.<span class="na">parentNode</span>);
<span class="nx">assert</span>.<span class="na">same</span>(<span class="nx">newNode</span>.<span class="na">parentNode</span>, <span class="nx">parent</span>);
<span class="nx">assert</span>.<span class="na">same</span>(<span class="nx">parent</span>.<span class="na">lastChild</span>, <span class="nx">newNode</span>);
<span class="nx">assert</span>.<span class="na">same</span>(<span class="nx">oldParent</span>.<span class="na">childNodes</span>.<span class="na">length</span>, <span class="m">0</span>);</div></div></pre></div></div></div></div></div></section><section class="jsdoc-module" id="koru/dom/html-doc::Element"><a class="jsdoc-module-path" href="#koru/dom/html-doc::Element">koru/dom/html-doc::Element</a><h2 class="jsdoc-module-title">Element</h2><abstract><div><p>Server side implementation of the DOM tree.</p>
</div></abstract><aside class="jsdoc-module-sidebar"></aside><div><div class="jsdoc-methods"><h4>Methods</h4><div><div class=" jsdoc-module-section" id="koru/dom/html-doc::Element#getElementsByClassName" name="#getElementsByClassName"><h5>Element#getElementsByClassName(className)</h5><abstract><div><p>Returns a list of all elements which have <code>className</code>.</p>
<p>See <a href="https://developer.mozilla.org/en-US/docs/Web/API/Element/getElementsByClassName">Element.getElementsByClassName()</a></p>
</div></abstract><div class="jsdoc-args"><h6>Parameters</h6><table><tbody><tr class="jsdoc-arg"><td>className</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></td><td class="jsdoc-info"><div></div></td></tr><tr class="jsdoc-method-returns"><td><h6>Returns</h6></td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array">Array</a></td><td class="jsdoc-info"><div></div></td></tr></tbody></table></div><div><h6>Example</h6><pre class="jsdoc-example"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">Document</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/dom/html-doc"</span>);</div><div class="jsdoc-example-call jsdoc-code-block"><div class="highlight"><span class="kd">const</span> <span class="nx">html</span> = <span class="nx">Dom</span>.<span class="na">h</span>({ <span class="na">div</span>: [{}, { <span class="na">div</span>: [{ <span class="na">class</span>: <span class="s">'foo bar'</span> }, { <span class="na">div</span>: { <span class="na">class</span>: <span class="s">'foo bar-foo'</span> } }] }] });

<span class="nx">assert</span>.<span class="na">equals</span>(<span class="nx">html</span>.<span class="na">getElementsByClassName</span>(<span class="s">'foo'</span>).<span class="na">length</span>, <span class="m">2</span>);
<span class="nx">assert</span>.<span class="na">equals</span>(<span class="nx">html</span>.<span class="na">getElementsByClassName</span>(<span class="s">'bar'</span>).<span class="na">length</span>, <span class="m">1</span>);
<span class="nx">assert</span>.<span class="na">same</span>(<span class="nx">html</span>.<span class="na">getElementsByClassName</span>(<span class="s">'bar'</span>)[<span class="m">0</span>].<span class="na">className</span>, <span class="s">'foo bar'</span>);</div></div></pre></div></div></div></div></div></section><section class="jsdoc-module" id="koru/dom/template"><a class="jsdoc-module-path" href="#koru/dom/template">koru/dom/template</a><h2 class="jsdoc-module-title">DomTemplate</h2><abstract><div><p>DomTemplate is used to create interactive
<a href="https://developer.mozilla.org/en-US/docs/Web/API/Node">Dom Trees</a></p>
</div></abstract><aside class="jsdoc-module-sidebar"><div class="jsdoc-availability">client only</div><div><h5>Modules required</h5><div class="jsdoc-list"><a class="jsdoc-link" href="#koru/dom/base">koru/dom/base</a><a class="jsdoc-link" href="#koru/dom/ctx">koru/dom/ctx</a><a class="jsdoc-link" href="#koru/main">koru/main</a><a class="jsdoc-link" href="#koru/make-subject">koru/make-subject</a><a class="jsdoc-link" href="#koru/util">koru/util</a></div></div></aside><div><div class="jsdoc-methods"><h4>Methods</h4><div><div class=" jsdoc-module-section" id="koru/dom/template.newTemplate" name="newTemplate"><h5>DomTemplate.newTemplate(module, blueprint)</h5><abstract><div><p>Create a new <code>DomTemplate</code> from an html blueprint.</p>
</div></abstract><div class="jsdoc-args"><h6>Parameters</h6><table><tbody><tr class="jsdoc-arg"><td>[module]</td><td><a href="https://www.npmjs.com/package/yaajs#api_Module">Module</a></td><td class="jsdoc-info"><div><p>if supplied the template will be deleted if
<code>module</code> is unloaded</p>
</div></td></tr><tr class="jsdoc-arg"><td>blueprint</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></td><td class="jsdoc-info"><div><p>A blue print is usually built by
<a class="jsdoc-link" href="#koru/dom/template-compiler">koru/dom/template-compiler</a> which is called automatically
on html files loaded using
<code>require('koru/html!path/to/my-template.html')</code></p>
</div></td></tr><tr class="jsdoc-method-returns"><td><h6>Returns</h6></td><td><a href="#koru/dom/template">koru/dom/template</a></td><td class="jsdoc-info"><div></div></td></tr></tbody></table></div><div><h6>Example</h6><pre class="jsdoc-example"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">DomTemplate</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/dom/template"</span>);</div><div class="jsdoc-example-call highlight"><div><span class="nx">DomTemplate</span>.<span class="na">newTemplate</span>(<span class="ge nx">{Module:myMod}</span>, <span class="ge nx">{name: 'Foo', nodes: [{name: 'div'}]}</span>);</div><span class="jsdoc-returns c1"> // returns <span class="ge nx">DomTemplate:Foo</span></span></div></pre></div></div></div></div></div></section><section class="jsdoc-module" id="koru/idle-check"><a class="jsdoc-module-path" href="#koru/idle-check">koru/idle-check</a><h2 class="jsdoc-module-title">IdleCheck</h2><abstract><div><p>IdleCheck keeps count of usage and notifies when idle.</p>
</div></abstract><aside class="jsdoc-module-sidebar"><div class="jsdoc-availability">server only</div><div><h5>Modules required</h5><div class="jsdoc-list"><a class="jsdoc-link" href="#koru/util">koru/util</a></div></div></aside><div><div class=" jsdoc-module-section" id="koru/idle-check.constructor" name="constructor"><h4>constructor()</h4><abstract><div></div></abstract><div><h6>Example</h6><pre class="jsdoc-example highlight"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">IdleCheck</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/idle-check"</span>);</div><div><div class="highlight"><span class="k">new</span> <span class="nx">IdleCheck</span>();</div></div></pre></div></div><div class="jsdoc-properties"><h5>Properties</h5><table><tbody><tr><td>singleton</td><td><a href="#koru/idle-check">koru/idle-check</a></td><td class="jsdoc-info"><div><p>The default <code>IdleCheck</code>. It is used by
<a class="jsdoc-link" href="#koru/web-server-factory">koru/WebServerFactory</a> and
<a class="jsdoc-link" href="#koru/session/server-connection">koru/session/server-connection</a></p>
</div></td></tr></tbody></table></div><div class="jsdoc-methods"><h4>Methods</h4><div><div class=" jsdoc-module-section" id="koru/idle-check#waitIdle" name="#waitIdle"><h5>IdleCheck#waitIdle(func)</h5><abstract><div><p>waitIdle waits until <code>this.count</code> drops to zero.</p>
</div></abstract><div class="jsdoc-args"><h6>Parameters</h6><table><tbody><tr class="jsdoc-arg"><td>func</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function">function</a></td><td class="jsdoc-info"><div></div></td></tr></tbody></table></div><div><h6>Example</h6><pre class="jsdoc-example"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">IdleCheck</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/idle-check"</span>);</div><div class="jsdoc-example-call jsdoc-code-block"><div class="highlight"><span class="kd">const</span> <span class="nx">check</span> = <span class="k">new</span> <span class="nx">IdleCheck</span>();
<span class="nx">check</span>.<span class="na">waitIdle</span>(<span class="nx">v</span>.<span class="na">stub</span> <span class="o">=</span> <span class="nx">test</span>.<span class="na">stub</span>());
<span class="nx">assert</span>.<span class="na">called</span>(<span class="nx">v</span>.<span class="na">stub</span>);</div></div></pre></div></div></div></div></div></section><section class="jsdoc-module" id="koru/pg/driver"><a class="jsdoc-module-path" href="#koru/pg/driver">koru/pg/driver</a><h2 class="jsdoc-module-title">pg</h2><abstract><div><p>Interface to PostgreSQL.</p>
</div></abstract><aside class="jsdoc-module-sidebar"><div class="jsdoc-availability">server only</div><div><h5>Modules required</h5><div class="jsdoc-list"><a class="jsdoc-link" href="#koru/main">koru/main</a><a class="jsdoc-link" href="#koru/make-subject">koru/make-subject</a><a class="jsdoc-link" href="#koru/match">koru/match</a><a class="jsdoc-link" href="#koru/pool-server">koru/pool-server</a><a class="jsdoc-link" href="#koru/util">koru/util</a></div></div></aside><div><table class="jsdoc-config"><tr><td colspan="2"><h5>Config</h5></td></tr><tr class="jsdoc-config-item"><td>url</td><td><div><p>The default url to connect to; see
<a href="https://www.npmjs.com/package/pg-libpq">pg-libpq</a>, <a href="http://www.postgresql.org/docs/9.4/interactive/libpq-connect.html">libpq -<br>PQconnectdb</a></p>
</div></td></tr></table><div class="jsdoc-properties"><h5>Properties</h5><table><tbody><tr><td>defaultDb</td><td><a href="#koru/pg/driver::Client">koru/pg/driver::Client</a></td><td class="jsdoc-info"><div><p>Return the default Client database connection.</p>
</div></td></tr></tbody></table></div><div class="jsdoc-methods"><h4>Methods</h4><div><div class=" jsdoc-module-section" id="koru/pg/driver.connect" name="connect"><h5>pg.connect(url, name)</h5><abstract><div><p>Create a new database Client connected to the <code>url</code></p>
</div></abstract><div class="jsdoc-args"><h6>Parameters</h6><table><tbody><tr class="jsdoc-arg"><td>url</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></td><td class="jsdoc-info"><div></div></td></tr><tr class="jsdoc-arg"><td>[name]</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></td><td class="jsdoc-info"><div><p>The name to give to the connection. By default
it is the schema name.</p>
</div></td></tr><tr class="jsdoc-method-returns"><td><h6>Returns</h6></td><td><a href="#koru/pg/driver::Client">koru/pg/driver::Client</a></td><td class="jsdoc-info"><div></div></td></tr></tbody></table></div><div><h6>Example</h6><pre class="jsdoc-example"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">pg</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/pg/driver"</span>);</div><div class="jsdoc-example-call highlight"><div><span class="nx">pg</span>.<span class="na">connect</span>(<span class="s">"host=/var/run/postgresql dbname=korutest options='-c search_path=public,pg_catalog'"</span>);</div><span class="jsdoc-returns c1"> // returns <span class="ge nx">Pg:host=/var/run/postgresql dbname=korutest options='-c search_path=public,pg_catalog'</span></span></div><div class="jsdoc-example-call highlight"><div><span class="nx">pg</span>.<span class="na">connect</span>(<span class="s">"postgresql://localhost/korutest"</span>, <span class="s">"conn2"</span>);</div><span class="jsdoc-returns c1"> // returns <span class="ge nx">Pg:postgresql://localhost/korutest</span></span></div></pre></div></div></div></div></div></section><section class="jsdoc-module" id="koru/pg/driver::Client"><a class="jsdoc-module-path" href="#koru/pg/driver::Client">koru/pg/driver::Client</a><h2 class="jsdoc-module-title">Client</h2><abstract><div><p>A connection to a database.</p>
<p>See <a class="jsdoc-link" href="#koru/pg/driver.connect">koru/pg/pg.connect</a></p>
</div></abstract><aside class="jsdoc-module-sidebar"><div class="jsdoc-availability">server only</div></aside><div><div class="jsdoc-methods"><h4>Methods</h4><div><div class=" jsdoc-module-section" id="koru/pg/driver::Client#jsFieldToPg" name="#jsFieldToPg"><h5>Client#jsFieldToPg(col, type)</h5><abstract><div></div></abstract><div class="jsdoc-args"><h6>Parameters</h6><table><tbody><tr class="jsdoc-arg"><td>col</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></td><td class="jsdoc-info"><div></div></td></tr><tr class="jsdoc-arg"><td>[type]</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>&nbsp;or<br><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></td><td class="jsdoc-info"><div></div></td></tr><tr class="jsdoc-method-returns"><td><h6>Returns</h6></td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></td><td class="jsdoc-info"><div></div></td></tr></tbody></table></div><div><h6>Example</h6><pre class="jsdoc-example"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">pg</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/pg/driver"</span>);</div><div class="highlight jsdoc-inst-init"><span class="kd">const</span> <span class="nx">client</span> = <span class="nx">pg</span>.<span class="na">defaultDb</span>;</div><div class="jsdoc-example-call highlight"><div><span class="nx">client</span>.<span class="na">jsFieldToPg</span>(<span class="s">"runs"</span>, <span class="s">"number"</span>);</div><span class="jsdoc-returns c1"> // returns <span class="s">"\"runs\" double precision"</span></span></div><div class="jsdoc-example-call highlight"><div><span class="nx">client</span>.<span class="na">jsFieldToPg</span>(<span class="s">"name"</span>);</div><span class="jsdoc-returns c1"> // returns <span class="s">"\"name\" text"</span></span></div><div class="jsdoc-example-call highlight"><div><span class="nx">client</span>.<span class="na">jsFieldToPg</span>(<span class="s">"dob"</span>, <span class="ge nx">{type: 'date'}</span>);</div><span class="jsdoc-returns c1"> // returns <span class="s">"\"dob\" date"</span></span></div><div class="jsdoc-example-call highlight"><div><span class="nx">client</span>.<span class="na">jsFieldToPg</span>(<span class="s">"map"</span>, <span class="ge nx">{default: {treasure: 'lost'}, type: 'object'}</span>);</div><span class="jsdoc-returns c1"> // returns <span class="s">"\"map\" jsonb DEFAULT '{\"treasure\":\"lost\"}'::jsonb"</span></span></div></pre></div></div></div></div></div></section><section class="jsdoc-module" id="koru/session/main"><a class="jsdoc-module-path" href="#koru/session/main">koru/session/main</a><h2 class="jsdoc-module-title">session</h2><abstract><div><p>The main or active session for client server communication.
See <a class="jsdoc-link" href="#koru/session/web-socket-sender-factory">koru/session/webSocketSenderFactory</a></p>
</div></abstract><aside class="jsdoc-module-sidebar"><div><h5>Modules required</h5><div class="jsdoc-list"><span><a class="jsdoc-link" href="#koru/session/main-client">koru/session/main-client</a><br><a class="jsdoc-link" href="#koru/session/main-server">koru/session/main-server</a></span><a class="jsdoc-link" href="#koru/session/base">koru/session/base</a></div></div></aside><div><div class="jsdoc-properties"><h5>Properties</h5><table><tbody><tr><td>_id</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></td><td class="jsdoc-info"><div><p>The session _id: "default"</p>
</div></td></tr></tbody></table></div><div class="jsdoc-methods"><h4>Methods</h4><div><div class=" jsdoc-module-section" id="koru/session/main.defineRpc" name="defineRpc"><h5>session.defineRpc(name, func)</h5><abstract><div><p>Define a remote proceedure call</p>
</div></abstract><div class="jsdoc-args"><h6>Parameters</h6><table><tbody><tr class="jsdoc-arg"><td>name</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></td><td class="jsdoc-info"><div></div></td></tr><tr class="jsdoc-arg"><td>func</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function">function</a></td><td class="jsdoc-info"><div></div></td></tr><tr class="jsdoc-method-returns"><td><h6>Returns</h6></td><td><a href="#koru/session/base">koru/session/base</a></td><td class="jsdoc-info"><div></div></td></tr></tbody></table></div><div><h6>Example</h6><pre class="jsdoc-example"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">session</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/session/main"</span>);</div><div class="jsdoc-example-call highlight"><div><span class="nx">session</span>.<span class="na">defineRpc</span>(<span class="s">"Book.list"</span>, <span class="ge nx">func</span>);</div><span class="jsdoc-returns c1"> // returns <span class="ge nx">koru/session/base</span></span></div></pre></div></div></div></div></div></section><section class="jsdoc-module" id="koru/session/client-sub"><a class="jsdoc-module-path" href="#koru/session/client-sub">koru/session/client-sub</a><h2 class="jsdoc-module-title">ClientSub</h2><abstract><div><p>A subscription to a publication</p>
<h5 id="construction">Construction</h5>
<p>See <a class="jsdoc-link" href="#koru/session/subscribe">koru/session/subcribe</a></p>
</div></abstract><aside class="jsdoc-module-sidebar"><div class="jsdoc-availability">client only</div><div><h5>Modules required</h5><div class="jsdoc-list"><a class="jsdoc-link" href="#koru/main">koru/main</a><a class="jsdoc-link" href="#koru/session/publish">koru/session/publish</a><a class="jsdoc-link" href="#koru/trace">koru/trace</a><a class="jsdoc-link" href="#koru/util">koru/util</a></div></div></aside><div><div class="jsdoc-methods"><h4>Methods</h4><div><div class=" jsdoc-module-section" id="koru/session/client-sub#filterModels" name="#filterModels"><h5>ClientSub#filterModels()</h5><abstract><div><p>Remove model documents that do not match this subscription</p>
</div></abstract><div><h6>Example</h6><pre class="jsdoc-example"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">ClientSub</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/session/client-sub"</span>);</div><div class="highlight jsdoc-inst-init">
<span class="kd">const</span> <span class="nx">subscribe</span> = <span class="nx">require</span>(<span class="s">'koru/session/subscribe'</span>);
<span class="kd">const</span> <span class="nx">clientSub</span> = <span class="nx">subscribe</span>(<span class="s">"Library"</span>);</div><div class="jsdoc-example-call highlight"><div><span class="nx">clientSub</span>.<span class="na">filterModels</span>(<span class="s">"Book"</span>, <span class="s">"Catalog"</span>);</div><div></div></div></pre></div></div></div></div></div></section><section class="jsdoc-module" id="koru/session/publish-test-helper-client"><a class="jsdoc-module-path" href="#koru/session/publish-test-helper-client">koru/session/publish-test-helper-client</a><h2 class="jsdoc-module-title">publishTH</h2><abstract><div><p>Utilities to help test publish/subscribe</p>
</div></abstract><aside class="jsdoc-module-sidebar"><div class="jsdoc-availability">client only</div><div><h5>Modules required</h5><div class="jsdoc-list"><a class="jsdoc-link" href="#koru/util">koru/util</a></div></div></aside><div><div class="jsdoc-methods"><h4>Methods</h4><div><div class=" jsdoc-module-section" id="koru/session/publish-test-helper-client.mockSubscribe" name="mockSubscribe"><h5>publishTH.mockSubscribe()</h5><abstract><div><p>Subscribe to a publication but do not call server.</p>
</div></abstract><div class="jsdoc-args"><h6>Parameters</h6><table><tbody><tr class="jsdoc-method-returns"><td><h6>Returns</h6></td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></td><td class="jsdoc-info"><div></div></td></tr></tbody></table></div><div><h6>Example</h6><pre class="jsdoc-example"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">publishTH</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/session/publish-test-helper-client"</span>);</div><div class="jsdoc-example-call highlight"><div><span class="nx">publishTH</span>.<span class="na">mockSubscribe</span>(<span class="s">"Foo"</span>);</div><span class="jsdoc-returns c1"> // returns <span class="ge nx">{}</span></span></div></pre></div></div></div></div></div></section><section class="jsdoc-module" id="koru/session/subscribe"><a class="jsdoc-module-path" href="#koru/session/subscribe">koru/session/subscribe</a><h2 class="jsdoc-module-title">subcribe</h2><abstract><div><p>Main publication subscriber. An instance of
<a href="#koru/session/subscribe-factory">subscribeFactory</a> on the
<a href="#koru/session/main">main session</a></p>
</div></abstract><aside class="jsdoc-module-sidebar"><div class="jsdoc-availability">client only</div><div><h5>Modules required</h5><div class="jsdoc-list"><a class="jsdoc-link" href="#koru/session/main">koru/session/main</a><a class="jsdoc-link" href="#koru/session/subscribe-factory">koru/session/subscribe-factory</a></div></div></aside><div></div></section><section class="jsdoc-module" id="koru/session/subscribe-factory"><a class="jsdoc-module-path" href="#koru/session/subscribe-factory">koru/session/subscribe-factory</a><h2 class="jsdoc-module-title">subscribeFactory</h2><abstract><div><p>Build a subscriber for a <code>session</code>.</p>
</div></abstract><aside class="jsdoc-module-sidebar"><div class="jsdoc-availability">client only</div><div><h5>Modules required</h5><div class="jsdoc-list"><a class="jsdoc-link" href="#koru/main">koru/main</a><a class="jsdoc-link" href="#koru/session/client-sub">koru/session/client-sub</a><a class="jsdoc-link" href="#koru/session/client-update">koru/session/client-update</a><a class="jsdoc-link" href="#koru/session/message">koru/session/message</a><a class="jsdoc-link" href="#koru/session/publish">koru/session/publish</a><a class="jsdoc-link" href="#koru/user-account/client-login">koru/user-account/client-login</a><a class="jsdoc-link" href="#koru/util">koru/util</a></div></div></aside><div><div class=" jsdoc-module-section" id="koru/session/subscribe-factory.constructor" name="constructor"><h4>subscribeFactory(session)</h4><abstract><div></div></abstract><div class="jsdoc-args"><h6>Parameters</h6><table><tbody><tr class="jsdoc-arg"><td>session</td><td></td><td class="jsdoc-info"><div></div></td></tr></tbody></table></div><div><h6>Example</h6><pre class="jsdoc-example highlight"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">subscribeFactory</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/session/subscribe-factory"</span>);</div><div><div class="highlight"><span class="kd">const</span> <span class="nx">subscribe</span> = <span class="nx">subscribeFactory</span>(<span class="nx">mySession</span>);
<span class="kd">const</span> <span class="nx">sub</span> = <span class="nx">subscribe</span>(<span class="s">"Library"</span>);

<span class="nx">assert</span>(<span class="nx">sub</span> <span class="o">instanceof</span> <span class="nx">ClientSub</span>);</div></div></pre></div></div></div></section><section class="jsdoc-module" id="koru/session/web-socket-sender-factory"><a class="jsdoc-module-path" href="#koru/session/web-socket-sender-factory">koru/session/web-socket-sender-factory</a><h2 class="jsdoc-module-title">webSocketSenderFactory</h2><abstract><div><p>Build WebSocket clients (senders).</p>
</div></abstract><aside class="jsdoc-module-sidebar"><div><h5>Modules required</h5><div class="jsdoc-list"><a class="jsdoc-link" href="#koru/main">koru/main</a><a class="jsdoc-link" href="#koru/session/message">koru/session/message</a><a class="jsdoc-link" href="#koru/util">koru/util</a></div></div></aside><div><div class=" jsdoc-module-section" id="koru/session/web-socket-sender-factory.constructor" name="constructor"><h4>webSocketSenderFactory(session, sessState,<br>                                  execWrapper=koru.fiberConnWrapper, base=session)</h4><abstract><div></div></abstract><div class="jsdoc-args"><h6>Parameters</h6><table><tbody><tr class="jsdoc-arg"><td>session</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></td><td class="jsdoc-info"><div></div></td></tr><tr class="jsdoc-arg"><td>sessState</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></td><td class="jsdoc-info"><div></div></td></tr><tr class="jsdoc-arg"><td>[execWrapper]</td><td></td><td class="jsdoc-info"><div></div></td></tr><tr class="jsdoc-arg"><td>[base]</td><td></td><td class="jsdoc-info"><div></div></td></tr></tbody></table></div><div><h6>Example</h6><pre class="jsdoc-example highlight"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">webSocketSenderFactory</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/session/web-socket-sender-factory"</span>);</div><div><div class="highlight"><span class="kd">const</span> <span class="nx">mySession</span> = <span class="nx">webSocketSenderFactory</span>(<span class="k">new</span> <span class="nx">SessionBase</span>(<span class="s">'foo'</span>), <span class="nx">stateFactory</span>());
<span class="kd">const</span> <span class="nx">wsConnection</span> = {};
<span class="nx">mySession</span>.<span class="na">newWs</span> <span class="o">=</span> <span class="nx">test</span>.<span class="na">stub</span>().<span class="na">returns</span>(<span class="nx">wsConnection</span>);

<span class="nx">mySession</span>.<span class="na">connect</span>();

<span class="nx">assert</span>.<span class="na">called</span>(<span class="nx">mySession</span>.<span class="na">newWs</span>);
<span class="nx">assert</span>.<span class="na">same</span>(<span class="nx">wsConnection</span>.<span class="na">binaryType</span>, <span class="s">'arraybuffer'</span>);</div></div></pre></div></div></div></section><section class="jsdoc-module" id="koru/test/api"><a class="jsdoc-module-path" href="#koru/test/api">koru/test/api</a><h2 class="jsdoc-module-title">API</h2><abstract><div><p>API is a semi-automatic API document generator. It uses
unit-tests to determine types and values at test time.</p>
</div></abstract><aside class="jsdoc-module-sidebar"><div><h5>Modules required</h5><div class="jsdoc-list"><span><a class="jsdoc-link" href="#koru/test/api-client">koru/test/api-client</a><br><a class="jsdoc-link" href="#koru/test/api-server">koru/test/api-server</a></span><a class="jsdoc-link" href="#koru/main">koru/main</a><a class="jsdoc-link" href="#koru/test/main">koru/test/main</a><a class="jsdoc-link" href="#koru/util">koru/util</a></div></div></aside><div><div class="jsdoc-methods"><h4>Methods</h4><div><div class=" jsdoc-module-section" id="koru/test/api.module" name="module"><h5>API.module(module, subjectName, options)</h5><abstract><div><p>Initiate documentation of the module. Subsequent calls to API
methods will act of the given <code>module</code>.</p>
</div></abstract><div class="jsdoc-args"><h6>Parameters</h6><table><tbody><tr class="jsdoc-arg"><td>[module]</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></td><td class="jsdoc-info"><div><p>defaults to the module corresponding to the
current test module</p>
</div></td></tr><tr class="jsdoc-arg"><td>[subjectName]</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></td><td class="jsdoc-info"><div><p>defaults to a hopefully reasonable name</p>
</div></td></tr><tr class="jsdoc-arg"><td>[options]</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></td><td class="jsdoc-info"><div><p>adornments to the documentation:</p>
<ul>
<li><code>initExample</code> - code that can be used to initialize
<code>subject</code></li>
<li><code>initInstExample</code> - code that can be used to initialize
an instance of <code>subject</code></li>
</ul>
</div></td></tr><tr class="jsdoc-method-returns"><td><h6>Returns</h6></td><td><a href="#koru/test/api">koru/test/api</a></td><td class="jsdoc-info"><div></div></td></tr></tbody></table></div><div><h6>Example</h6><pre class="jsdoc-example"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">API</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/test/api"</span>);</div><div class="jsdoc-example-call highlight"><div><span class="nx">API</span>.<span class="na">module</span>();</div><span class="jsdoc-returns c1"> // returns <span class="ge nx">{API(API)}</span></span></div><div class="jsdoc-example-call highlight"><div><span class="nx">API</span>.<span class="na">module</span>(<span class="ge nx">{exports: {clean: =&gt; clean}, id: 'myMod1'}</span>, <span class="s">"myHelper"</span>, <span class="ge nx">{initExample: 'Init example', initInstExample: 'Init inst example'}</span>);</div><span class="jsdoc-returns c1"> // returns <span class="ge nx">{API(myHelper)}</span></span></div><div class="jsdoc-example-call highlight"><div><span class="nx">API</span>.<span class="na">module</span>(<span class="ge nx">{exports: =&gt; Book, id: 'myMod2'}</span>);</div><span class="jsdoc-returns c1"> // returns <span class="ge nx">{API(Book)}</span></span></div></pre></div></div><div class=" jsdoc-module-section" id="koru/test/api.innerSubject" name="innerSubject"><h5>API.innerSubject(subject, subjectName, options)</h5><abstract><div><p>Document a subject within a module.</p>
</div></abstract><div class="jsdoc-args"><h6>Parameters</h6><table><tbody><tr class="jsdoc-arg"><td>subject</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a>&nbsp;or<br><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></td><td class="jsdoc-info"><div><p>either the actual subject or the property name
of the subject if accessible from the current subject</p>
</div></td></tr><tr class="jsdoc-arg"><td>[subjectName]</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>&nbsp;or<br><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Null">null</a></td><td class="jsdoc-info"><div><p>override the subject name</p>
</div></td></tr><tr class="jsdoc-arg"><td>[options]</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></td><td class="jsdoc-info"><div><p>adornments to the documentation:</p>
<ul>
<li><code>intro|info</code> - property info line (if subject is a <code>string</code>)</li>
<li><code>abstract</code> - introduction to the subject. If abstract is a
<code>function</code> then the initial doc comment is used.</li>
<li><code>initExample</code> - code that can be used to initialize
<code>subject</code></li>
<li><code>initInstExample</code> - code that can be used to initialize
an instance of <code>subject</code></li>
</ul>
</div></td></tr><tr class="jsdoc-method-returns"><td><h6>Returns</h6></td><td><a href="#koru/test/api">koru/test/api</a></td><td class="jsdoc-info"><div><p>an API instance for the given <code>subject</code>. Subsequent
API calls should be made directly on this API instance and
<strong>not</strong> the API Class itself</p>
</div></td></tr></tbody></table></div><div><h6>Example</h6><pre class="jsdoc-example"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">API</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/test/api"</span>);</div><div class="jsdoc-example-call highlight"><div><span class="nx">API</span>.<span class="na">innerSubject</span>(<span class="ge nx">{anything: 'is allowed'}</span>, <span class="s">"Anything can be documented"</span>, <span class="ge nx">{abstract: =&gt; abstract, initExample: 'const init = {sample: 'code'};', initInstExample: 'const inst = initCode();'}</span>);</div><span class="jsdoc-returns c1"> // returns <span class="ge nx">{API(Anything can be documented)}</span></span></div><div class="jsdoc-example-call jsdoc-code-block"><div class="highlight"><span class="k">class</span> <span class="nx">Book</span> {
  <span class="k">constructor</span>() {
    <span class="k">this</span>.<span class="na">_chapters</span> <span class="o">=</span> [];
  }
  <span class="nf">newChapter</span>() {
    <span class="kd">const</span> <span class="nx">chapter</span> = <span class="k">new</span> <span class="k">this</span>.<span class="na">constructor</span>.<span class="na">Chapter</span>(<span class="m">10</span>);
    <span class="k">this</span>.<span class="na">_chapters</span>.<span class="na">push</span>(<span class="nx">chapter</span>);
    <span class="k">return</span> <span class="nx">chapter</span>;
  }
};
<span class="nx">Book</span>.<span class="na">Chapter</span> <span class="o">=</span> <span class="k">class</span> {
  <span class="k">constructor</span>(<span class="nx">startPage</span>) {
    <span class="k">this</span>.<span class="na">page</span> <span class="o">=</span> <span class="nx">startPage</span>;
  }
  <span class="nf">goto</span>() {
    <span class="k">return</span> <span class="k">this</span>.<span class="na">page</span>;
  }
};;

<span class="nx">API</span>.<span class="na">module</span>({ <span class="na">id</span>: <span class="s">'myMod1'</span>, <span class="na">exports</span>: <span class="nx">Book</span> }, <span class="s">'myHelper'</span>);
<span class="nx">API</span>.<span class="na">innerSubject</span>(<span class="s">'Chapter'</span>, <span class="kc">null</span>, {
  <span class="na">info</span>: <span class="s">'Chapter info'</span>
}).<span class="na">protoMethod</span>(<span class="s">'goto'</span>);

<span class="kd">const</span> <span class="nx">book</span> = <span class="k">new</span> <span class="nx">Book</span>();
<span class="kd">const</span> <span class="nx">chapter</span> = <span class="nx">book</span>.<span class="na">newChapter</span>();
<span class="nx">assert</span>.<span class="na">same</span>(<span class="nx">chapter</span>.<span class="na">goto</span>(), <span class="m">10</span>);</div></div></pre></div></div><div class=" jsdoc-module-section" id="koru/test/api.example" name="example"><h5>API.example(body)</h5><abstract><div><p>Run a section of as an example of a method call.</p>
</div></abstract><div class="jsdoc-args"><h6>Parameters</h6><table><tbody><tr class="jsdoc-arg"><td>body</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function">function</a></td><td class="jsdoc-info"><div></div></td></tr></tbody></table></div><div><h6>Example</h6><pre class="jsdoc-example"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">API</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/test/api"</span>);</div><div class="jsdoc-example-call highlight"><div><span class="nx">API</span>.<span class="na">example</span>(<span class="ge nx">() =&gt; {/*...*/}</span>);</div><div></div></div><div class="jsdoc-example-call jsdoc-code-block"><div class="highlight"><span class="k">class</span> <span class="nx">Color</span> {
  <span class="k">static</span> <span class="nf">define</span>(<span class="nx">name</span>, <span class="nx">value</span>) {
    <span class="k">this</span>.<span class="na">colors</span>[<span class="nx">name</span>] <span class="o">=</span> <span class="nx">value</span>;
  }
  <span class="cs">// ...</span>
}
<span class="nx">Color</span>.<span class="na">colors</span> <span class="o">=</span> {};

<span class="nx">API</span>.<span class="na">module</span>({ <span class="na">id</span>: <span class="s">'myMod'</span>, <span class="na">exports</span>: <span class="nx">Color</span> });
<span class="nx">API</span>.<span class="na">method</span>(<span class="s">'define'</span>);

<span class="nx">API</span>.<span class="na">example</span>(() <span class="o">=&gt;</span> {
  <span class="cs">// this body of code is executed</span>
  <span class="nx">Color</span>.<span class="na">define</span>(<span class="s">'red'</span>, <span class="s">'#f00'</span>);
  <span class="nx">Color</span>.<span class="na">define</span>(<span class="s">'blue'</span>, <span class="s">'#00f'</span>);
  <span class="nx">assert</span>.<span class="na">same</span>(<span class="nx">Color</span>.<span class="na">colors</span>.<span class="na">red</span>, <span class="s">'#f00'</span>);
});</div></div></pre></div></div><div class=" jsdoc-module-section" id="koru/test/api.comment" name="comment"><h5>API.comment(comment)</h5><abstract><div><p>Add a comment before the next example</p>
</div></abstract><div class="jsdoc-args"><h6>Parameters</h6><table><tbody><tr class="jsdoc-arg"><td>comment</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></td><td class="jsdoc-info"><div></div></td></tr></tbody></table></div><div><h6>Example</h6><pre class="jsdoc-example"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">API</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/test/api"</span>);</div><div class="jsdoc-example-call jsdoc-code-block"><div class="highlight"><span class="k">class</span> <span class="nx">Excercise</span> {
  <span class="k">static</span> <span class="nf">register</span>(<span class="nx">name</span>, <span class="nx">minutes</span>) {}
  <span class="nf">begin</span>() {}
}

<span class="nx">API</span>.<span class="na">module</span>({ <span class="na">id</span>: <span class="s">'myMod'</span>, <span class="na">exports</span>: <span class="nx">Excercise</span> });
<span class="nx">API</span>.<span class="na">method</span>(<span class="s">'register'</span>);

<span class="nx">API</span>.<span class="na">comment</span>(<span class="s">'Optionally set the default duration'</span>);
<span class="nx">Excercise</span>.<span class="na">register</span>(<span class="s">'Jogging'</span>, <span class="m">5</span>); <span class="cs">// This call gets the comment</span>
<span class="nx">Excercise</span>.<span class="na">register</span>(<span class="s">'Skipping'</span>); <span class="cs">// This call get no comment</span></div></div></pre></div></div><div class=" jsdoc-module-section" id="koru/test/api.property" name="property"><h5>API.property(name, options)</h5><abstract><div><p>Document a property of the current subject. The property
can be either plain value or a get/set function.</p>
</div></abstract><div class="jsdoc-args"><h6>Parameters</h6><table><tbody><tr class="jsdoc-arg"><td>name</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></td><td class="jsdoc-info"><div></div></td></tr><tr class="jsdoc-arg"><td>[options]</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a>&nbsp;or<br><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function">function</a></td><td class="jsdoc-info"><div><p>details about the property.</p>
<p>When <code>object</code> can contain the following:</p>
<ul>
<li><code>info</code> (or <code>intro</code>): description of property</li>
<li><code>properties</code>: document child properties</li>
</ul>
<p>When <code>function</code> should return an info <code>string</code>. The info
<code>string</code> can contain <code>${value}</code> which will be substituted
with a description of the properties value.</p>
</div></td></tr><tr class="jsdoc-method-returns"><td><h6>Returns</h6></td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Undefined">undefined</a></td><td class="jsdoc-info"><div></div></td></tr></tbody></table></div><div><h6>Example</h6><pre class="jsdoc-example"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">API</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/test/api"</span>);</div><div class="jsdoc-example-call jsdoc-code-block"><div class="highlight"><span class="nx">v</span>.<span class="na">defaults</span> <span class="o">=</span> {
  <span class="na">logger</span>: <span class="kd">function</span> () {},
  <span class="na">width</span>: <span class="m">800</span>,
  <span class="na">height</span>: <span class="m">600</span>,
  <span class="na">theme</span>: {
    <span class="na">name</span>: <span class="s">'light'</span>,
    <span class="na">primaryColor</span>: <span class="s">'#aaf'</span>
  }
};

<span class="nx">API</span>.<span class="na">module</span>({ <span class="na">id</span>: <span class="s">'myMod'</span>, <span class="na">exports</span>: <span class="nx">v</span>.<span class="na">defaults</span> }, <span class="s">'defaults'</span>);
<span class="nx">API</span>.<span class="na">property</span>(<span class="s">'theme'</span>, {
  <span class="na">info</span>: <span class="s">'The default theme'</span>,
  <span class="na">properties</span>: {
    <span class="na">name</span>: <span class="nx">value</span> <span class="o">=&gt;</span> {
      <span class="nx">v</span>.<span class="na">name</span> <span class="o">=</span> <span class="nx">value</span>;
      <span class="k">return</span> <span class="s">'The theme name is ${value}'</span>;
    },
    <span class="na">primaryColor</span>: <span class="s">'The primary color is ${value}'</span>
  }
});
<span class="nx">assert</span>.<span class="na">same</span>(<span class="nx">v</span>.<span class="na">name</span>, <span class="s">'light'</span>);

<span class="nx">API</span>.<span class="na">property</span>(<span class="s">'logger'</span>, <span class="nx">value</span> <span class="o">=&gt;</span> {
  <span class="nx">v</span>.<span class="na">logger</span> <span class="o">=</span> <span class="nx">value</span>;
  <span class="k">return</span> <span class="s">'The default logger is ${value}'</span>;
});

<span class="nx">assert</span>.<span class="na">same</span>(<span class="nx">v</span>.<span class="na">logger</span>, <span class="nx">v</span>.<span class="na">defaults</span>.<span class="na">logger</span>);</div></div><div class="jsdoc-example-call highlight"><div><span class="nx">API</span>.<span class="na">property</span>(<span class="s">"width"</span>);</div><span class="jsdoc-returns c1"> // returns <span class="ge nx">undefined</span></span></div><div class="jsdoc-example-call jsdoc-code-block"><div class="highlight"><span class="kd">const</span> <span class="nx">book</span> = {
  <span class="k">get</span> <span class="nf">title</span>() {
    <span class="k">return</span> <span class="k">this</span>.<span class="na">_title</span>;
  },
  <span class="k">set</span> <span class="nf">title</span>(<span class="nx">value</span>) {
    <span class="k">this</span>.<span class="na">_title</span> <span class="o">=</span> <span class="nx">value</span>;
  }
};

<span class="nx">API</span>.<span class="na">module</span>({ <span class="na">id</span>: <span class="s">'myMod'</span>, <span class="na">exports</span>: <span class="nx">book</span> }, <span class="s">'Room'</span>);
<span class="nx">API</span>.<span class="na">property</span>(<span class="s">'title'</span>, {
  <span class="na">info</span>: <span class="s">'Get/set the book title'</span>
});
<span class="nx">API</span>.<span class="na">comment</span>(<span class="s">'sets title'</span>);
<span class="nx">book</span>.<span class="na">title</span> <span class="o">=</span> <span class="s">'Room'</span>;
<span class="nx">assert</span>.<span class="na">same</span>(<span class="nx">book</span>.<span class="na">_title</span>, <span class="s">'Room'</span>);
<span class="nx">assert</span>.<span class="na">same</span>(<span class="nx">book</span>.<span class="na">title</span>, <span class="nx">book</span>.<span class="na">_title</span>);</div></div></pre></div></div><div class=" jsdoc-module-section" id="koru/test/api.protoProperty" name="protoProperty"><h5>API.protoProperty(name, options)</h5><abstract><div><p>Document a property of the current subject's prototype. The
property can be either plain value or a get/set function.</p>
<p>See <a class="jsdoc-link" href="#koru/test/api.property">.property</a></p>
</div></abstract><div class="jsdoc-args"><h6>Parameters</h6><table><tbody><tr class="jsdoc-arg"><td>name</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></td><td class="jsdoc-info"><div></div></td></tr><tr class="jsdoc-arg"><td>options</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></td><td class="jsdoc-info"><div></div></td></tr></tbody></table></div><div><h6>Example</h6><pre class="jsdoc-example"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">API</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/test/api"</span>);</div><div class="jsdoc-example-call jsdoc-code-block"><div class="highlight"><span class="k">class</span> <span class="nx">Book</span> {
  <span class="k">constructor</span>(<span class="nx">pages</span>) {
    <span class="k">this</span>.<span class="na">pages</span> <span class="o">=</span> <span class="nx">pages</span>;
  }
}

<span class="nx">API</span>.<span class="na">module</span>({ <span class="na">id</span>: <span class="s">'myMod'</span>, <span class="na">exports</span>: <span class="nx">Book</span> });
<span class="nx">API</span>.<span class="na">protoProperty</span>(<span class="s">'page'</span>, { <span class="na">info</span>: <span class="s">'The number of pages'</span> });
<span class="kd">const</span> <span class="nx">book</span> = <span class="k">new</span> <span class="nx">Book</span>(<span class="m">504</span>);
<span class="nx">assert</span>.<span class="na">same</span>(<span class="nx">book</span>.<span class="na">pages</span>, <span class="m">504</span>);</div></div></pre></div></div><div class=" jsdoc-module-section" id="koru/test/api.new" name="new"><h5>API.new(sig)</h5><abstract><div><p>Document <code>constructor</code> for the current subject</p>
</div></abstract><div class="jsdoc-args"><h6>Parameters</h6><table><tbody><tr class="jsdoc-arg"><td>[sig]</td><td></td><td class="jsdoc-info"><div><p>override the call signature</p>
</div></td></tr><tr class="jsdoc-method-returns"><td><h6>Returns</h6></td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function">function</a></td><td class="jsdoc-info"><div><p>a ProxyClass which is to be used instead of <code>new Class</code></p>
</div></td></tr></tbody></table></div><div><h6>Example</h6><pre class="jsdoc-example"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">API</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/test/api"</span>);</div><div class="jsdoc-example-call highlight"><div><span class="nx">API</span>.<span class="na">new</span>();</div><span class="jsdoc-returns c1"> // returns <span class="ge nx">newProxy</span></span></div></pre></div></div><div class=" jsdoc-module-section" id="koru/test/api.method" name="method"><h5>API.method(methodName)</h5><abstract><div><p>Document <code>methodName</code> for the current subject</p>
</div></abstract><div class="jsdoc-args"><h6>Parameters</h6><table><tbody><tr class="jsdoc-arg"><td>methodName</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></td><td class="jsdoc-info"><div></div></td></tr></tbody></table></div><div><h6>Example</h6><pre class="jsdoc-example"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">API</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/test/api"</span>);</div><div class="jsdoc-example-call highlight"><div><span class="nx">API</span>.<span class="na">method</span>(<span class="s">"fnord"</span>);</div><div></div></div></pre></div></div><div class=" jsdoc-module-section" id="koru/test/api.protoMethod" name="protoMethod"><h5>API.protoMethod(methodName, subject)</h5><abstract><div><p>Document prototype <code>methodName</code> for the current subject</p>
</div></abstract><div class="jsdoc-args"><h6>Parameters</h6><table><tbody><tr class="jsdoc-arg"><td>methodName</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></td><td class="jsdoc-info"><div></div></td></tr><tr class="jsdoc-arg"><td>[subject]</td><td></td><td class="jsdoc-info"><div></div></td></tr></tbody></table></div><div><h6>Example</h6><pre class="jsdoc-example"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">API</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/test/api"</span>);</div><div class="jsdoc-example-call jsdoc-code-block"><div class="highlight"><span class="k">class</span> <span class="nx">Tree</span> {
  <span class="k">constructor</span>(<span class="nx">name</span>) {
    <span class="k">this</span>.<span class="na">name</span> <span class="o">=</span> <span class="nx">name</span>;
    <span class="k">this</span>.<span class="na">branches</span> <span class="o">=</span> <span class="m">10</span>;
  }

  <span class="nf">prune</span>(<span class="nx">branchCount</span>) {
    <span class="k">return</span> <span class="k">this</span>.<span class="na">branches</span> <span class="o">-=</span> <span class="nx">branchCount</span>;
  }
};

<span class="nx">API</span>.<span class="na">module</span>({ <span class="na">id</span>: <span class="s">'myMod'</span>, <span class="na">exports</span>: <span class="nx">Tree</span> });
<span class="nx">API</span>.<span class="na">protoMethod</span>(<span class="s">'prune'</span>);

<span class="kd">const</span> <span class="nx">plum</span> = <span class="k">new</span> <span class="nx">Tree</span>(<span class="s">'Plum'</span>);
<span class="nx">assert</span>.<span class="na">same</span>(<span class="nx">plum</span>.<span class="na">prune</span>(<span class="m">3</span>), <span class="m">7</span>);
<span class="nx">assert</span>.<span class="na">same</span>(<span class="nx">plum</span>.<span class="na">prune</span>(<span class="m">2</span>), <span class="m">5</span>);</div></div></pre></div></div></div></div></div></section><section class="jsdoc-module" id="koru/ui/route"><a class="jsdoc-module-path" href="#koru/ui/route">koru/ui/route</a><h2 class="jsdoc-module-title">Route</h2><abstract><div><p>Route is a paginging system within a one page app. It manages
creating and destroying pages and recording history.</p>
</div></abstract><aside class="jsdoc-module-sidebar"><div class="jsdoc-availability">client only</div><div><h5>Modules required</h5><div class="jsdoc-list"><a class="jsdoc-link" href="#koru/dom">koru/dom</a><a class="jsdoc-link" href="#koru/main">koru/main</a><a class="jsdoc-link" href="#koru/make-subject">koru/make-subject</a><a class="jsdoc-link" href="#koru/trace">koru/trace</a><a class="jsdoc-link" href="#koru/ui/dom-ext">koru/ui/dom-ext</a><a class="jsdoc-link" href="#koru/util">koru/util</a></div></div></aside><div><div class="jsdoc-methods"><h4>Methods</h4><div><div class=" jsdoc-module-section" id="koru/ui/route.setTitle" name="setTitle"><h5>Route.setTitle(title)</h5><abstract><div><p>Set the <code>document.title</code> for the current page.</p>
</div></abstract><div class="jsdoc-args"><h6>Parameters</h6><table><tbody><tr class="jsdoc-arg"><td>title</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></td><td class="jsdoc-info"><div></div></td></tr></tbody></table></div><div><h6>Example</h6><pre class="jsdoc-example"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">Route</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/ui/route"</span>);</div><div class="jsdoc-example-call highlight"><div><span class="nx">Route</span>.<span class="na">setTitle</span>(<span class="s">"my title"</span>);</div><div></div></div></pre></div></div><div class=" jsdoc-module-section" id="koru/ui/route.gotoPage" name="gotoPage"><h5>Route.gotoPage(page, pageRoute)</h5><abstract><div><p>Goto the specified <code>page</code> and record in <code>window.history</code>.</p>
</div></abstract><div class="jsdoc-args"><h6>Parameters</h6><table><tbody><tr class="jsdoc-arg"><td>page</td><td><a href="#koru/dom/template">koru/dom/template</a></td><td class="jsdoc-info"><div></div></td></tr><tr class="jsdoc-arg"><td>pageRoute</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></td><td class="jsdoc-info"><div></div></td></tr></tbody></table></div><div><h6>Example</h6><pre class="jsdoc-example"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">Route</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/ui/route"</span>);</div><div class="jsdoc-example-call highlight"><div><span class="nx">Route</span>.<span class="na">gotoPage</span>(<span class="ge nx">DomTemplate:Test.AdminProfile</span>, <span class="ge nx">{append: 'my/id'}</span>);</div><div></div></div></pre></div></div><div class=" jsdoc-module-section" id="koru/ui/route.replacePage" name="replacePage"><h5>Route.replacePage()</h5><abstract><div><p>Like <a class="jsdoc-link" href="#koru/ui/route.gotoPage">.gotoPage</a> but replaces to <code>window.history</code>
rather than adding to it.</p>
</div></abstract><div class="jsdoc-args"><h6>Parameters</h6><table><tbody><tr class="jsdoc-method-returns"><td><h6>Returns</h6></td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></td><td class="jsdoc-info"><div></div></td></tr></tbody></table></div><div><h6>Example</h6><pre class="jsdoc-example"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">Route</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/ui/route"</span>);</div><div class="jsdoc-example-call highlight"><div><span class="nx">Route</span>.<span class="na">replacePage</span>(<span class="s">"myPage"</span>, <span class="ge nx">{append: 'myId'}</span>);</div><span class="jsdoc-returns c1"> // returns <span class="s">"replaceState"</span></span></div></pre></div></div></div></div></div></section><section class="jsdoc-module" id="koru/util"><a class="jsdoc-module-path" href="#koru/util">koru/util</a><h2 class="jsdoc-module-title">util</h2><abstract><div><p>The util module provides commonly performed utility functions.</p>
</div></abstract><aside class="jsdoc-module-sidebar"><div><h5>Modules required</h5><div class="jsdoc-list"><a class="jsdoc-link" href="#koru/match">koru/match</a><a class="jsdoc-link" href="#koru/stacktrace">koru/stacktrace</a><a class="jsdoc-link" href="#koru/util-base">koru/util-base</a></div></div></aside><div><div class="jsdoc-methods"><h4>Methods</h4><div><div class=" jsdoc-module-section" id="koru/util.toDp" name="toDp"><h5>util.toDp(number, dp, zeroFill)</h5><abstract><div><p>Return a floating point <code>number</code> as a string to
<code>dp</code> decimal places.</p>
</div></abstract><div class="jsdoc-args"><h6>Parameters</h6><table><tbody><tr class="jsdoc-arg"><td>number</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></td><td class="jsdoc-info"><div></div></td></tr><tr class="jsdoc-arg"><td>dp</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></td><td class="jsdoc-info"><div></div></td></tr><tr class="jsdoc-arg"><td>[zeroFill]</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></td><td class="jsdoc-info"><div><p>pad with zeros.</p>
</div></td></tr><tr class="jsdoc-method-returns"><td><h6>Returns</h6></td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></td><td class="jsdoc-info"><div></div></td></tr></tbody></table></div><div><h6>Example</h6><pre class="jsdoc-example"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">util</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/util"</span>);</div><div class="jsdoc-example-call highlight"><div><span class="nx">util</span>.<span class="na">toDp</span>(<span class="m">10.7</span>, <span class="m">0</span>);</div><span class="jsdoc-returns c1"> // returns <span class="s">"11"</span></span></div><div class="jsdoc-example-call highlight"><div><span class="nx">util</span>.<span class="na">toDp</span>(<span class="m">2.6</span>, <span class="m">1</span>);</div><span class="jsdoc-returns c1"> // returns <span class="s">"2.6"</span></span></div><div class="jsdoc-example-call highlight"><div><span class="nx">util</span>.<span class="na">toDp</span>(<span class="m">1.2345</span>, <span class="m">3</span>, <span class="kc">true</span>);</div><span class="jsdoc-returns c1"> // returns <span class="s">"1.235"</span></span></div><div class="jsdoc-example-call highlight"><div><span class="nx">util</span>.<span class="na">toDp</span>(<span class="m">1.2</span>, <span class="m">3</span>, <span class="kc">true</span>);</div><span class="jsdoc-returns c1"> // returns <span class="s">"1.200"</span></span></div><div class="jsdoc-example-call highlight"><div><span class="nx">util</span>.<span class="na">toDp</span>(<span class="m">10</span>, <span class="m">3</span>);</div><span class="jsdoc-returns c1"> // returns <span class="s">"10"</span></span></div></pre></div></div><div class=" jsdoc-module-section" id="koru/util.pc" name="pc"><h5>util.pc(fraction)</h5><abstract><div><p>Convert a <code>fraction</code> into css % string</p>
</div></abstract><div class="jsdoc-args"><h6>Parameters</h6><table><tbody><tr class="jsdoc-arg"><td>fraction</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></td><td class="jsdoc-info"><div></div></td></tr><tr class="jsdoc-method-returns"><td><h6>Returns</h6></td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></td><td class="jsdoc-info"><div></div></td></tr></tbody></table></div><div><h6>Example</h6><pre class="jsdoc-example"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">util</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/util"</span>);</div><div class="jsdoc-example-call highlight"><div><span class="nx">util</span>.<span class="na">pc</span>(<span class="m">1.2345678</span>);</div><span class="jsdoc-returns c1"> // returns <span class="s">"123.45678%"</span></span></div></pre></div></div><div class=" jsdoc-module-section" id="koru/util.px" name="px"><h5>util.px(value)</h5><abstract><div><p>Convert a <code>fraction</code> into css % string</p>
</div></abstract><div class="jsdoc-args"><h6>Parameters</h6><table><tbody><tr class="jsdoc-arg"><td>value</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></td><td class="jsdoc-info"><div></div></td></tr><tr class="jsdoc-method-returns"><td><h6>Returns</h6></td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></td><td class="jsdoc-info"><div></div></td></tr></tbody></table></div><div><h6>Example</h6><pre class="jsdoc-example"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">util</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/util"</span>);</div><div class="jsdoc-example-call highlight"><div><span class="nx">util</span>.<span class="na">px</span>(<span class="m">123.2345678</span>);</div><span class="jsdoc-returns c1"> // returns <span class="s">"123px"</span></span></div></pre></div></div><div class=" jsdoc-module-section" id="koru/util.removeItem" name="removeItem"><h5>util.removeItem(list, item)</h5><abstract><div><p>remove an <code>item</code> from a <code>list</code>. <code>list</code> is modified.</p>
</div></abstract><div class="jsdoc-args"><h6>Parameters</h6><table><tbody><tr class="jsdoc-arg"><td>list</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array">Array</a></td><td class="jsdoc-info"><div></div></td></tr><tr class="jsdoc-arg"><td>[item]</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a>&nbsp;or<br><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></td><td class="jsdoc-info"><div><p>can be a key-value object to compare the given keys.</p>
</div></td></tr><tr class="jsdoc-method-returns"><td><h6>Returns</h6></td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a>&nbsp;or<br><a href="https://developer.mozilla.org/en-US/docs/Glossary/Primitive">primitive</a></td><td class="jsdoc-info"><div><p>the removed item.</p>
</div></td></tr></tbody></table></div><div><h6>Example</h6><pre class="jsdoc-example"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">util</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/util"</span>);</div><div class="jsdoc-example-call highlight"><div><span class="nx">util</span>.<span class="na">removeItem</span>(<span class="ge nx">[]</span>, <span class="m">2</span>);</div><span class="jsdoc-returns c1"> // returns <span class="m">2</span></span></div><div class="jsdoc-example-call highlight"><div><span class="nx">util</span>.<span class="na">removeItem</span>(<span class="ge nx">[]</span>, <span class="m">4</span>);</div><div></div></div><div class="jsdoc-example-call highlight"><div><span class="nx">util</span>.<span class="na">removeItem</span>(<span class="ge nx">[]</span>, <span class="m">1</span>);</div><span class="jsdoc-returns c1"> // returns <span class="m">1</span></span></div><div class="jsdoc-example-call highlight"><div><span class="nx">util</span>.<span class="na">removeItem</span>(<span class="ge nx">[]</span>, <span class="m">3</span>);</div><span class="jsdoc-returns c1"> // returns <span class="m">3</span></span></div><div class="jsdoc-example-call highlight"><div><span class="nx">util</span>.<span class="na">removeItem</span>(<span class="ge nx">[]</span>);</div><div></div></div><div class="jsdoc-example-call highlight"><div><span class="nx">util</span>.<span class="na">removeItem</span>(<span class="ge nx">[{x: 1}]</span>, <span class="ge nx">{name: 'bar', x: 1}</span>);</div><div></div></div><div class="jsdoc-example-call highlight"><div><span class="nx">util</span>.<span class="na">removeItem</span>(<span class="ge nx">[{x: 1}]</span>, <span class="ge nx">{name: 'bar'}</span>);</div><span class="jsdoc-returns c1"> // returns <span class="ge nx">{id: 5, name: 'bar'}</span></span></div><div class="jsdoc-example-call highlight"><div><span class="nx">util</span>.<span class="na">removeItem</span>(<span class="ge nx">[{x: 1}]</span>, <span class="ge nx">{id: 4, name: 'foo'}</span>);</div><span class="jsdoc-returns c1"> // returns <span class="ge nx">{id: 4, name: 'foo'}</span></span></div></pre></div></div><div class=" jsdoc-module-section" id="koru/util.intersectp" name="intersectp"><h5>util.intersectp(list1, list2)</h5><abstract><div><p>Determine if <code>list1</code> and <code>list2</code> intersect</p>
</div></abstract><div class="jsdoc-args"><h6>Parameters</h6><table><tbody><tr class="jsdoc-arg"><td>list1</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array">Array</a></td><td class="jsdoc-info"><div></div></td></tr><tr class="jsdoc-arg"><td>list2</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array">Array</a></td><td class="jsdoc-info"><div></div></td></tr><tr class="jsdoc-method-returns"><td><h6>Returns</h6></td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></td><td class="jsdoc-info"><div></div></td></tr></tbody></table></div><div><h6>Example</h6><pre class="jsdoc-example"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">util</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/util"</span>);</div><div class="jsdoc-example-call highlight"><div><span class="nx">util</span>.<span class="na">intersectp</span>(<span class="ge nx">[1, 4]</span>, <span class="ge nx">[4, 5]</span>);</div><span class="jsdoc-returns c1"> // returns <span class="kc">true</span></span></div><div class="jsdoc-example-call highlight"><div><span class="nx">util</span>.<span class="na">intersectp</span>(<span class="ge nx">[1, 2]</span>, <span class="ge nx">['a']</span>);</div><span class="jsdoc-returns c1"> // returns <span class="kc">false</span></span></div></pre></div></div><div class=" jsdoc-module-section" id="koru/util.reverseForEach" name="reverseForEach"><h5>util.reverseForEach(list, visitor)</h5><abstract><div><p>Visit <code>list</code> in reverse order.</p>
</div></abstract><div class="jsdoc-args"><h6>Parameters</h6><table><tbody><tr class="jsdoc-arg"><td>list</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array">Array</a>&nbsp;or<br><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Null">null</a></td><td class="jsdoc-info"><div></div></td></tr><tr class="jsdoc-arg"><td>visitor</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function">function</a></td><td class="jsdoc-info"><div><p>called with the list <code>item</code> and <code>index</code></p>
</div></td></tr></tbody></table></div><div><h6>Example</h6><pre class="jsdoc-example"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">util</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/util"</span>);</div><div class="jsdoc-example-call jsdoc-code-block"><div class="highlight"><span class="kd">var</span> <span class="nx">results</span> = [];
<span class="nx">util</span>.<span class="na">reverseForEach</span>(<span class="nx">v</span>.<span class="na">list</span> <span class="o">=</span> [<span class="m">1</span>, <span class="m">2</span>, <span class="m">3</span>], (<span class="nx">val</span>, <span class="nx">index</span>) <span class="o">=&gt;</span> {
  <span class="nx">results</span>.<span class="na">push</span>(<span class="nx">val</span> <span class="o">+</span> <span class="s">"."</span> <span class="o">+</span> <span class="nx">index</span>);
});
<span class="nx">assert</span>.<span class="na">equals</span>(<span class="nx">results</span>, [<span class="s">'3.2'</span>, <span class="s">'2.1'</span>, <span class="s">'1.0'</span>]);

<span class="cs">// ignores null list</span>
<span class="nx">util</span>.<span class="na">reverseForEach</span>(<span class="kc">null</span>, <span class="nx">v</span>.<span class="na">stub</span> <span class="o">=</span> <span class="nx">test</span>.<span class="na">stub</span>());
<span class="nx">refute</span>.<span class="na">called</span>(<span class="nx">v</span>.<span class="na">stub</span>);</div></div></pre></div></div></div></div></div></section><section class="jsdoc-module" id="koru/web-server"><a class="jsdoc-module-path" href="#koru/web-server">koru/web-server</a><h2 class="jsdoc-module-title">webServer</h2><abstract><div><p>The default web-server created from <a class="jsdoc-link" href="#koru/web-server-factory">koru/WebServerFactory</a>.
<a class="jsdoc-link" href="#koru/idle-check">koru/IdleCheck</a> is used to keep track of active
requests.</p>
</div></abstract><aside class="jsdoc-module-sidebar"><div class="jsdoc-availability">server only</div><div><h5>Modules required</h5><div class="jsdoc-list"><a class="jsdoc-link" href="#koru/main">koru/main</a><a class="jsdoc-link" href="#koru/web-server-factory">koru/web-server-factory</a></div></div></aside><div><table class="jsdoc-config"><tr><td colspan="2"><h5>Config</h5></td></tr><tr class="jsdoc-config-item"><td>defaultPage</td><td><div><p>defaults to <code>/index.html</code>: used when no path
is supplied in the url.</p>
</div></td></tr><tr class="jsdoc-config-item"><td>host</td><td><div><p>listen on the specified address</p>
</div></td></tr><tr class="jsdoc-config-item"><td>index.js</td><td><div><p>the file to serve for <code>index.js</code> or
<code>require.js</code>; defaults to <code>yaajs.js</code></p>
</div></td></tr><tr class="jsdoc-config-item"><td>koru</td><td><div><p>where to find koru files; defaults to <code>app/koru</code></p>
</div></td></tr><tr class="jsdoc-config-item"><td>port</td><td><div><p>listen on the specified port</p>
</div></td></tr><tr class="jsdoc-config-item"><td>require.js</td><td><div><p>alias for <code>index.js</code></p>
</div></td></tr></table><div class="jsdoc-methods"><h4>Methods</h4><div><div class=" jsdoc-module-section" id="koru/web-server.start" name="start"><h5>webServer.start()</h5><abstract><div></div></abstract><div><h6>Example</h6><pre class="jsdoc-example"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">webServer</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/web-server"</span>);</div><div class="jsdoc-example-call jsdoc-code-block"><div class="highlight"><span class="kd">const</span> { <span class="nx">Server</span> } = <span class="nx">requirejs</span>.<span class="na">nodeRequire</span>(<span class="s">'http'</span>);

<span class="kd">const</span> <span class="nx">listen</span> = <span class="nx">test</span>.<span class="na">stub</span>(<span class="nx">Server</span>.<span class="na">prototype</span>, <span class="s">'listen'</span>).<span class="na">yields</span>();
<span class="nx">webServer</span>.<span class="na">start</span>();
<span class="nx">assert</span>.<span class="na">calledWith</span>(<span class="nx">listen</span>, <span class="nx">webServerModule</span>.<span class="na">config</span>().<span class="na">port</span>);</div></div></pre></div></div></div></div></div></section><section class="jsdoc-module" id="koru/web-server-factory"><a class="jsdoc-module-path" href="#koru/web-server-factory">koru/web-server-factory</a><h2 class="jsdoc-module-title">WebServerFactory</h2><abstract><div><p>Factory for creating web-servers.</p>
</div></abstract><aside class="jsdoc-module-sidebar"><div class="jsdoc-availability">server only</div><div><h5>Modules required</h5><div class="jsdoc-list"><a class="jsdoc-link" href="#koru/fs-tools">koru/fs-tools</a><a class="jsdoc-link" href="#koru/idle-check">koru/idle-check</a><a class="jsdoc-link" href="#koru/main">koru/main</a><a class="jsdoc-link" href="#koru/queue">koru/queue</a><a class="jsdoc-link" href="#koru/util">koru/util</a></div></div></aside><div><div class=" jsdoc-module-section" id="koru/web-server-factory.constructor" name="constructor"><h4>constructor(host, port, root, DEFAULT_PAGE='/index.html', SPECIALS={})</h4><abstract><div><p>Create a new web server. The npm package
<a href="https://www.npmjs.com/package/send">send</a> is used to serve
files.</p>
</div></abstract><div class="jsdoc-args"><h6>Parameters</h6><table><tbody><tr class="jsdoc-arg"><td>host</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></td><td class="jsdoc-info"><div></div></td></tr><tr class="jsdoc-arg"><td>port</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></td><td class="jsdoc-info"><div></div></td></tr><tr class="jsdoc-arg"><td>root</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></td><td class="jsdoc-info"><div><p>Serve files relative to path.</p>
</div></td></tr><tr class="jsdoc-arg"><td>[DEFAULT_PAGE]</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></td><td class="jsdoc-info"><div></div></td></tr><tr class="jsdoc-arg"><td>[SPECIALS]</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></td><td class="jsdoc-info"><div></div></td></tr></tbody></table></div><div><h6>Example</h6><pre class="jsdoc-example highlight"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">WebServerFactory</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/web-server-factory"</span>);</div><div><div class="highlight"><span class="kd">const</span> <span class="nx">http</span> = <span class="nx">requirejs</span>.<span class="na">nodeRequire</span>(<span class="s">'http'</span>);
<span class="nx">test</span>.<span class="na">stub</span>(<span class="nx">http</span>, <span class="s">'createServer'</span>);
<span class="nx">v</span>.<span class="na">webServer</span> <span class="o">=</span> <span class="nx">WebServerFactory</span>(<span class="s">'0.0.0.0'</span>, <span class="s">'80'</span>, <span class="s">'/rootDir/'</span>, <span class="s">'/index2.html'</span>, { <span class="nf">gem</span>(<span class="nx">match</span>) {
    <span class="k">return</span> [<span class="nx">match</span>[<span class="m">0</span>], <span class="s">'/path-to-gems'</span>];
  } });
<span class="nx">assert</span>.<span class="na">calledWith</span>(<span class="nx">http</span>.<span class="na">createServer</span>, <span class="nx">v</span>.<span class="na">webServer</span>.<span class="na">requestListener</span>);</div></div><div><div class="highlight"><span class="k">new</span> <span class="nx">WebServerFactory</span>(<span class="s">"localhost"</span>, <span class="s">"9876"</span>, <span class="s">"/"</span>);</div></div></pre></div></div><div class="jsdoc-methods"><h4>Methods</h4><div><div class=" jsdoc-module-section" id="koru/web-server-factory#start" name="#start"><h5>WebServerFactory#start()</h5><abstract><div></div></abstract><div><h6>Example</h6><pre class="jsdoc-example"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">WebServerFactory</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/web-server-factory"</span>);</div><div class="jsdoc-example-call jsdoc-code-block"><div class="highlight"><span class="kd">const</span> { <span class="nx">Server</span> } = <span class="nx">requirejs</span>.<span class="na">nodeRequire</span>(<span class="s">'http'</span>);
<span class="kd">const</span> <span class="nx">listen</span> = <span class="nx">test</span>.<span class="na">stub</span>(<span class="nx">Server</span>.<span class="na">prototype</span>, <span class="s">'listen'</span>).<span class="na">yields</span>();

<span class="nx">v</span>.<span class="na">webServer</span>.<span class="na">start</span>();
<span class="nx">assert</span>.<span class="na">calledWith</span>(<span class="nx">listen</span>, <span class="s">'9876'</span>, <span class="s">'localhost'</span>);</div></div></pre></div></div><div class=" jsdoc-module-section" id="koru/web-server-factory#stop" name="#stop"><h5>WebServerFactory#stop()</h5><abstract><div></div></abstract><div><h6>Example</h6><pre class="jsdoc-example"><div class="jsdoc-require highlight"><span class="kd">const</span> <span class="nx">WebServerFactory</span> <span class="o">=</span> <span class="k">require</span>(<span class="s">"koru/web-server-factory"</span>);</div><div class="jsdoc-example-call jsdoc-code-block"><div class="highlight"><span class="kd">const</span> { <span class="nx">Server</span> } = <span class="nx">requirejs</span>.<span class="na">nodeRequire</span>(<span class="s">'http'</span>);
<span class="kd">const</span> <span class="nx">close</span> = <span class="nx">test</span>.<span class="na">stub</span>(<span class="nx">Server</span>.<span class="na">prototype</span>, <span class="s">'close'</span>);

<span class="nx">v</span>.<span class="na">webServer</span>.<span class="na">stop</span>();
<span class="nx">assert</span>.<span class="na">called</span>(<span class="nx">close</span>);</div></div></pre></div></div></div></div></div></section></div>
      </main>
    </div>
    <script src="https://code.getmdl.io/1.1.3/material.min.js"></script>
    <script src="api.js"></script>
  </body>
</html>
